---
title: "GOpro: Determine groups of genes and find their most 
    characteristic GO term"
author: "Lidia Chrabaszcz"
output: BiocStyle::html_document
vignette: >
  %\VignetteEncoding{UTF-8}
  %\VignetteIndexEntry{GOpro: Determine groups of genes and find their characteristic GO term}
  %\VignetteEngine{knitr::knitr}
---
```{r style, echo = FALSE, results = 'asis'}
BiocStyle::markdown()
```

# Installation
```{r, eval = FALSE}
source("http://www.bioconductor.org/biocLite.R")
biocLite("GOpro", dependencies = TRUE)
```
After the package is installed, it can be loaded into R workspace typing
# Loading
```{r, eval=TRUE, results='hide', warning=FALSE, message=FALSE}
library(GOpro)
```

# Overview
This document presents an overview of the GOpro package. 
This package is for determining groups of genes and finding characteristic 
functions for these groups. It allows for interpreting groups of genes by their 
most characteristic biological function. It provides a tool for determining 
significantly different genes between at least two  distinct groups 
(i.e. patients with different medical condition) which is ANOVA test with 
correction for multiple testing. It also gives two methods for grouping 
these genes. One of them is statistical that is pairwise comparisons 
between groups of patients' with different medical condition  genes 
using Tukey's method. By this method profiles of genes are determined, 
i.e. in terms of expressions genes are grouped according to the 
differences in the expressions between given groups of patients with 
different medical condition. Another method of grouping is hierarchical 
clustering. Next method provides finding the most characteristic GO terms
(biological functions of genes) for anteriorly obtained groups using 
one-sided Fisher's test for overrepresentation. If genes are grouped by 
hierarchical clustering, then the most characteristic function is 
found for all groups (for each node in the dendrogram).

# Data

Data used in this example come from 
[The Cancer Genome Atlas](https://tcga-data.nci.nih.gov/tcga/). 
They were downloaded via RTCGA.PANCAN12 package. The data represent 
expressions of 300 genes randomly chosen from 16115 genes determined 
for each patient (sample).  Three cohortss are 
included: acute myleoid leukemia, colon cancer, and bladder cancer.

```{r, cache=TRUE, results='hide', message=FALSE}
expr <- exrtcga
```

An example of the data:
```{r, echo=FALSE, results='markup'}
expr[[1]][1:5, 1:5]
```

# Example 
Genes aliases must be used as genes names and they must be arranged
in the same order for each group. Genes must be stored in rows and probes
(samples) in columns. Data frames of genes and patients observations
must be arranged into a list. The length of the list should be consistent 
with the number of data frames (different groups of probes).

Having in mind that data should be normally distributed, the analysis 
of variance test is conducted by function *aovTopTest*. 
The *top* parameter denotes the number of significantly different genes
to be given by this function. In the case of ties, all genes for which 
the p-value of the test is the same as for the last *top* are included 
in the result. 
```{r, echo=TRUE, results='markup'}
findGO(expr)
findGO(expr, extend = TRUE)
findGO(expr, grouped = 'clustering')
findGO(expr, grouped = 'clustering', extend = TRUE)
```
